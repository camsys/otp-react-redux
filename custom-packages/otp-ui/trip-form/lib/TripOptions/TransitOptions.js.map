{"version":3,"sources":["../../src/TripOptions/TransitOptions.tsx"],"names":["TransitOptions","checkboxIcons","DetailedModeIcon","onQueryParamChange","queryParams","supportedModes","transitModes","selectedModes","selectedTransit","filter","coreUtils","itinerary","isTransit","hasTransit","length","selectedAndVisibleTransit","forEach","m","some","t","mode","hidden","push","map","transitMode","allTransitEnabled","isChecked","label","concat","join","image","zIndex"],"mappings":"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","sourcesContent":["// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore FIXME: Create TypeScript types for core-utils packages.\nimport coreUtils from \"@opentripplanner/core-utils\";\nimport React from \"react\";\n\nimport * as S from \"./styled\";\nimport Checkbox from \"./Checkbox\";\nimport { CheckboxIcons, QueryProps } from \"./types\";\nimport { getSelectedModes } from \"./util\";\n\nconst TransitOptions = ({\n  checkboxIcons,\n  DetailedModeIcon,\n  onQueryParamChange,\n  queryParams,\n  supportedModes\n}: {\n  checkboxIcons?: CheckboxIcons;\n} & QueryProps): JSX.Element => {\n  const { transitModes } = supportedModes;\n  const selectedModes = getSelectedModes(queryParams);\n  const selectedTransit = selectedModes.filter(coreUtils.itinerary.isTransit);\n  const hasTransit = selectedTransit.length > 0;\n  if (!hasTransit) return null;\n  const selectedAndVisibleTransit = [];\n  transitModes.forEach(m => {\n    if (selectedTransit.some(t => t === m.mode) && !m.hidden) {\n      selectedAndVisibleTransit.push(m);\n    }\n  });\n  return (\n    <S.TransitOptionsContainer>\n      {transitModes.map(transitMode => {\n        if (transitMode.hidden) return null;\n        const allTransitEnabled = selectedModes.some(m => m === \"TRANSIT\");\n        const isChecked =\n          allTransitEnabled || selectedModes.some(m => m === transitMode.mode);\n        return (\n          <Checkbox\n            ariaLabel={transitMode.label}\n            checkboxIcons={checkboxIcons}\n            checked={isChecked}\n            /* This prevents the user from de-selecting a transit mode when it is the only one selected.\n            the selectedModes length being 3 indicates that only one mode is selected. GONDOLA, WALK, and the mode. */\n            disabled={isChecked && selectedModes.length === 3}\n            key={transitMode.mode}\n            inset\n            onClick={() => {\n              let mode = selectedModes;\n              // Remove mode from list if all transit is selected.\n              if (allTransitEnabled) {\n                mode = selectedModes\n                  .filter(m => m !== \"TRANSIT\")\n                  .concat(\n                    transitModes\n                      .filter(m => m.mode !== transitMode.mode)\n                      .map(m => m.mode)\n                  );\n              } else if (isChecked) {\n                // Handle unchecking.\n                // If this is the last visible transit mode, switch to WALK only.\n                mode =\n                  selectedAndVisibleTransit.length === 1\n                    ? [\"WALK\"]\n                    : selectedModes.filter(m => m !== transitMode.mode);\n              } else {\n                // Add mode to list.\n                mode = selectedModes.concat([transitMode.mode]);\n              }\n              onQueryParamChange({ mode: mode.join(\",\") });\n            }}\n            selected={isChecked}\n          >\n            {(DetailedModeIcon && (\n              <DetailedModeIcon mode={transitMode.mode} />\n            )) ||\n              (transitMode.image && (\n                <S.Image\n                  alt={`Image for ${transitMode.label}`}\n                  src={transitMode.image}\n                />\n              ))}\n            <span style={{ zIndex: 5 }}>{transitMode.label}</span>\n          </Checkbox>\n        );\n      })}\n    </S.TransitOptionsContainer>\n  );\n};\n\nexport default TransitOptions;\n"],"file":"TransitOptions.js"}